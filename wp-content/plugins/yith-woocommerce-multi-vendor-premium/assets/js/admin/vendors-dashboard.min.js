(()=>{"use strict";var e={};function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){if(t&&("object"==r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},u.apply(null,arguments)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const d={xhr:!1,block:function(e){e&&e.length&&void 0!==jQuery.fn.block&&(e.addClass("ajax-blocked"),e.block({message:null,overlayCSS:{background:"#fff no-repeat center",opacity:.5,cursor:"none"}}))},unblock:function(e){e&&e.hasClass("ajax-blocked")&&void 0!==jQuery.fn.block&&(e.unblock(),e.removeClass("ajax-blocked"))},call:function(e,t,r){var n=this;return r=void 0!==r?r:"GET",Array.isArray(e)?(e.push({name:"action",value:yith_wcmv_ajax.ajaxAction}),e.push({name:"security",value:yith_wcmv_ajax.ajaxNonce}),e.push({name:"context",value:"admin"})):(e.action=yith_wcmv_ajax.ajaxAction,e.security=yith_wcmv_ajax.ajaxNonce,e.context="admin"),n.block(t),n.xhr=jQuery.ajax({url:yith_wcmv_ajax.ajaxUrl,data:e,type:r}).fail((function(e){console.log(e),n.unblock(t)})).done((function(e){n.unblock(t),n.xhr=!1})),n.xhr},get:function(e,t){return this.call(e,t,"GET")},post:function(e,t){return this.call(e,t,"POST")},abort:function(){this.xhr&&this.xhr.abort()}};function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(f=function(){return!!e})()}var v=function(e){function r(){var e,n,i,o;t(this,r);for(var u=arguments.length,c=new Array(u),d=0;d<u;d++)c[d]=arguments[d];return n=this,i=r,o=[].concat(c),i=l(i),s(e=a(n,f()?Reflect.construct(i,o||[],l(n).constructor):i.apply(n,o)),"states",null),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(r,e),o(r,[{key:"init",value:function(){var e,t,n,i,o;"undefined"!=typeof yith_wcmv_vendors&&(this.states=JSON.parse(yith_wcmv_vendors.countries.replace(/&quot;/g,'"'))),this.container.find(".vendor-image-upload-input").each(this.initImageValue.bind(this)),this.container.on("change",".country-field",{self:this},this.changeCountry),jQuery(".country-field").change(),this.container.on("click",".upload_vendor_image_button",{self:this},this.uploadImage),this.container.on("click",".remove_vendor_image_button",{self:this},this.removeImage),(e=r,t="init",n=this,o=u(l(1&(i=3)?e.prototype:e),t,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([]),this.container.on("keyup",".ajax-check",{self:this},this.validateField),this.initSlugField()}},{key:"addImage",value:function(e,t,r){e.find('input[type="hidden"]').val(t),e.css("background-image","url("+r+")"),e.find(".upload_vendor_image_button").hide(),e.find(".remove_vendor_image_button").show()}},{key:"removeImage",value:function(e){e.preventDefault();var t=jQuery(this).closest(".vendor-image-upload");return t.find('input[type="hidden"]').val(""),t.css("background-image",""),t.find(".upload_vendor_image_button").show(),jQuery(this).hide(),!1}},{key:"changeCountry",value:function(e){var t=e.data.self;if(null!==t.states){var r,n=jQuery(this),i=n.val(),o=n.closest("form").find(".state-field"),a=o.parent(),l=o.val(),u=o.attr("name"),c=o.attr("id"),s=o.attr("placeholder");if(a.show().find(".select2-container").remove(),jQuery.isEmptyObject(t.states[i]))r=jQuery('<input type="text" />').prop("id",c).prop("name",u).prop("placeholder",s).addClass("state-field").val(l),o.replaceWith(r);else{var d=t.states[i],f=jQuery('<option value=""></option>').text(yith_wcmv_vendors.i18nSelectStateText);r=jQuery("<select></select>").prop("id",c).prop("name",u).prop("placeholder",s).addClass("state-field").append(f),jQuery.each(d,(function(e){var t=jQuery("<option></option>").prop("value",e).text(d[e]);e===l&&t.prop("selected"),r.append(t)})),r.val(l),o.replaceWith(r),r.show().selectWoo().hide().trigger("change")}}}},{key:"uploadImage",value:function(e){e.preventDefault();var t=e.data.self,r=jQuery(this).closest(".vendor-image-upload"),n=wp.media.frames.downloadable_file=wp.media({title:yith_wcmv_vendors.uploadFrameTitle,button:{text:yith_wcmv_vendors.uploadFrameButtonText},multiple:!1});n.on("select",(function(){var e=n.state().get("selection").first().toJSON();t.addImage(r,e.id,e.sizes.full.url)})),n.open()}},{key:"initImageValue",value:function(e,t){var r,n=jQuery(t),i=null!==(r=n.data("value"))&&void 0!==r?r:null;if(null!==i){for(var o in i)this.addImage(n.parent(),o,i[o]);n.removeAttr("data-value")}}},{key:"initSlugField",value:function(){var e=this.container.find("input#slug"),t=e.closest(".vendor-field").find(".description");t.data("text",t.text()),e.on("keyup",(function(){var e=jQuery(this).val();e?(e=e.toLowerCase().replace(/[^0-9a-z-]+/,"-"),t.text(t.data("text").replace("%yith_shop_vendor%",e)),jQuery(this).val(e)):t.text("")})).keyup()}},{key:"validateField",value:function(e){var t=e.data.self;d.abort();var r=jQuery(this),n=r.val();if(r.removeClass("error success"),!n.length)return!1;r.addClass("loading"),d.get({request:r.data("action"),value:n,vendor_id:t.container.find('input[name="vendor_id"]').val()}).fail((function(){r.removeClass("loading")})).done((function(e){r.removeClass("loading"),e.success?(r.addClass("success"),t.resetFieldError(r.attr("name"))):(r.addClass("error"),t.addFieldError(e.data.error,r.attr("name")))}))}}])}(function(){return o((function e(r){t(this,e),s(this,"container",null),this.container=r}),[{key:"init",value:function(){if(!this.container.length)return!1;jQuery(document).trigger("yith_fields_init"),jQuery(document.body).trigger("yith-plugin-fw-init-radio"),jQuery(document).trigger("yith-add-box-button-toggle"),this.initValue(),this.initEnhancedSelect(),this.initTinyMCE(),this.container.on("change",".field-required",{self:this},this.listenRequired),this.container.on("change",".email-validate",{self:this},this.validateEmail),this.container.closest("form").on("submit",this.checkFormErrors.bind(this))}},{key:"initTinyMCE",value:function(){"undefined"!=typeof tinyMCE&&"undefined"!=typeof tinyMCEPreInit&&this.container.find(".editor textarea").each((function(){var e=jQuery(this).attr("id"),t=tinyMCEPreInit.mceInit,r=Object.keys(t)[0],n=t[r],i=tinyMCEPreInit.qtInit,o=t[Object.keys(i)[0]];n.selector=e,n.body_class=n.body_class.replace(r,e),o.id=e,tinyMCE.init(n),tinyMCE.execCommand("mceRemoveEditor",!0,e),tinyMCE.execCommand("mceAddEditor",!0,e),quicktags(o),QTags._buttonsInit()}))}},{key:"initValue",value:function(){this.container.find(":input").each((function(){var e,t=jQuery(this),r=null!==(e=t.data("value"))&&void 0!==e?e:null;if(!t.is(":radio")&&"hidden"!==t.attr("type")&&null!==r)if(t.is(":checkbox")){var n=t.is(":checked");(!n&&"yes"===r||n&&"yes"!==r)&&t.click()}else t.val(r)}))}},{key:"initEnhancedSelect",value:function(){if("undefined"==typeof yith_wcmv_ajax||void 0===jQuery.fn.selectWoo)return!1;this.container.find("select.yith-wcmv-ajax-search").filter(":not(.initialized)").each((function(){var e,t=jQuery(this),r=null!==(e=t.data("value"))&&void 0!==e?e:null;if(null!==r)for(var n in r)t.append(new Option(r[n],n,!0,!0));t.trigger("change"),t.selectWoo({allowClear:!0,placeholder:jQuery(this).data("placeholder"),minimumInputLength:"3",escapeMarkup:function(e){return e},ajax:{url:yith_wcmv_ajax.ajaxUrl,dataType:"json",delay:1e3,data:function(e){return{term:e.term,request:jQuery(this).data("action"),action:yith_wcmv_ajax.ajaxAction,security:yith_wcmv_ajax.ajaxNonce,context:"admin"}},processResults:function(e){var t=[];return e.success&&jQuery.each(e.data,(function(e,r){t.push({id:e,text:r})})),{results:t}},cache:!0}}).addClass("initialized").on("select2:select",(function(e){t.find("option.value-placeholder").remove()})).on("select2:unselect",(function(e){var r=e.params.data.id;t.find('option[value="'+r+'"]').remove(),t.find("option").length||t.append('<option value="" class="value-placeholder"></option>')}))})),this.container.find("select").filter(":not(.initialized)").each((function(){var e,t=jQuery(this),r=null!==(e=t.data("value"))&&void 0!==e?e:null,n=jQuery(this).find("option").filter('[value=""]'),i={minimumResultsForSearch:20};n.length&&(i.placeholder={id:"",text:n.text()},i.allowClear=!0),null!==r&&(r+="",t.val(r.split(",")).change()),t.selectWoo(i).addClass("initialized")}))}},{key:"isValidEmail",value:function(e){return e.toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}},{key:"validateEmail",value:function(e){var t,r=e.data.self,n=jQuery(this),i=n.val();i&&!r.isValidEmail(i)?r.addFieldError(null===(t=yith_vendors)||void 0===t?void 0:t.emailFieldError,n.attr("name")):r.resetFieldError(n.attr("name"))}},{key:"addFormError",value:function(e,t){t.prepend('<div id="error-message">'+e+"</div>")}},{key:"addFieldError",value:function(e,t,r){r&&r.length||(r=this.container);var n=r.find('[name="'+t+'"]');n.length||this.addFormError(e,r);var i=n.next(".error-msg");n.addClass("field-error"),i.length?i.html(e):n.after('<span class="error-msg">'+e+"</span>")}},{key:"resetFormError",value:function(e){var t=this;e&&e.length||(e=this.container),e.find("#error-message").remove(),e.find(".field-error").each((function(e,r){t.resetFieldError(jQuery(r).attr("name"))}))}},{key:"resetFieldError",value:function(e){if(e&&this.container.find('[name="'+e+'"]')){var t=this.container.find('[name="'+e+'"]');t.removeClass("field-error"),t.next(".error-msg").remove()}}},{key:"listenRequired",value:function(e){var t,r=e.data.self,n=jQuery(this),i=n.attr("name");n.val()?n.hasClass("ajax-check")||r.resetFieldError(i):r.addFieldError(null===(t=yith_vendors)||void 0===t?void 0:t.requiredFieldError,i)}},{key:"isFormWithErrors",value:function(){var e=this.container.closest("form");return e.find(":input").filter(".field-required").trigger("change"),!!e.find("#error-message, .field-error").length}},{key:"checkFormErrors",value:function(e){this.isFormWithErrors()&&(e.preventDefault(),jQuery("html").animate({scrollTop:this.container.find("#error-message, .field-error").first().offset().top-100},1e3))}}])}()),h=jQuery(".vendor-fields-container");h.length&&new v(h).init();if(jQuery(document.body).hasClass("post-type-product")&&(yith_wcmv_vendors.hideImportProducts&&jQuery(".woocommerce-BlankState").find(".woocommerce-BlankState-cta.button").not(".button-primary").remove(),yith_wcmv_vendors.hideFeaturedProduct&&jQuery("#_featured").add('[for="_featured"]').remove()),(jQuery(document.body).hasClass("post-type-shop_order")||jQuery(document.body).hasClass("yith-wcfm-section-product_orders"))&&!jQuery(document.body).hasClass("vendor_quote_management")){var y,m,p;if(jQuery(".wc-order-edit-line-item").remove(),jQuery(".wc-order-edit-line-item-actions").remove(),jQuery("a.delete-order-tax").remove(),"no"===(null===(y=yith_wcmv_vendors.orderDataToShow)||void 0===y?void 0:y.customer)){var g=jQuery("#order_data").find(".wc-customer-user");g.replaceWith('<input type="hidden" name="customer_user" value="'+g.find("select").val()+'"/>'),jQuery(".wc-customer-search").remove()}"no"===(null===(m=yith_wcmv_vendors.orderDataToShow)||void 0===m?void 0:m.payment)&&jQuery("#order_data").find(".order_number").remove(),"no"===(null===(p=yith_wcmv_vendors.orderDataToShow)||void 0===p?void 0:p.address)&&jQuery("#order_data .order_data_column:nth-child(2)").add("#order_data .order_data_column:nth-child(3)").remove()}var j=window;for(var _ in e)j[_]=e[_];e.__esModule&&Object.defineProperty(j,"__esModule",{value:!0})})();