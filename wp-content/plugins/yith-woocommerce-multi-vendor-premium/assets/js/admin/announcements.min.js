(()=>{"use strict";var e={};function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,i(a.key),a)}}function r(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}const o={xhr:!1,block:function(e){e&&e.length&&void 0!==jQuery.fn.block&&(e.addClass("ajax-blocked"),e.block({message:null,overlayCSS:{background:"#fff no-repeat center",opacity:.5,cursor:"none"}}))},unblock:function(e){e&&e.hasClass("ajax-blocked")&&void 0!==jQuery.fn.block&&(e.unblock(),e.removeClass("ajax-blocked"))},call:function(e,t,n){var i=this;return n=void 0!==n?n:"GET",Array.isArray(e)?(e.push({name:"action",value:yith_wcmv_ajax.ajaxAction}),e.push({name:"security",value:yith_wcmv_ajax.ajaxNonce}),e.push({name:"context",value:"admin"})):(e.action=yith_wcmv_ajax.ajaxAction,e.security=yith_wcmv_ajax.ajaxNonce,e.context="admin"),i.block(t),i.xhr=jQuery.ajax({url:yith_wcmv_ajax.ajaxUrl,data:e,type:n}).fail((function(e){console.log(e),i.unblock(t)})).done((function(e){i.unblock(t),i.xhr=!1})),i.xhr},get:function(e,t){return this.call(e,t,"GET")},post:function(e,t){return this.call(e,t,"POST")},abort:function(){this.xhr&&this.xhr.abort()}};var l=function(){return r((function e(n){var a,r,o;t(this,e),a=this,o=null,(r=i(r="container"))in a?Object.defineProperty(a,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[r]=o,this.container=n}),[{key:"init",value:function(){if(!this.container.length)return!1;jQuery(document).trigger("yith_fields_init"),jQuery(document.body).trigger("yith-plugin-fw-init-radio"),jQuery(document).trigger("yith-add-box-button-toggle"),this.initValue(),this.initEnhancedSelect(),this.initTinyMCE(),this.container.on("change",".field-required",{self:this},this.listenRequired),this.container.on("change",".email-validate",{self:this},this.validateEmail),this.container.closest("form").on("submit",this.checkFormErrors.bind(this))}},{key:"initTinyMCE",value:function(){"undefined"!=typeof tinyMCE&&"undefined"!=typeof tinyMCEPreInit&&this.container.find(".editor textarea").each((function(){var e=jQuery(this).attr("id"),t=tinyMCEPreInit.mceInit,n=Object.keys(t)[0],i=t[n],a=tinyMCEPreInit.qtInit,r=t[Object.keys(a)[0]];i.selector=e,i.body_class=i.body_class.replace(n,e),r.id=e,tinyMCE.init(i),tinyMCE.execCommand("mceRemoveEditor",!0,e),tinyMCE.execCommand("mceAddEditor",!0,e),quicktags(r),QTags._buttonsInit()}))}},{key:"initValue",value:function(){this.container.find(":input").each((function(){var e,t=jQuery(this),n=null!==(e=t.data("value"))&&void 0!==e?e:null;if(!t.is(":radio")&&"hidden"!==t.attr("type")&&null!==n)if(t.is(":checkbox")){var i=t.is(":checked");(!i&&"yes"===n||i&&"yes"!==n)&&t.click()}else t.val(n)}))}},{key:"initEnhancedSelect",value:function(){if("undefined"==typeof yith_wcmv_ajax||void 0===jQuery.fn.selectWoo)return!1;this.container.find("select.yith-wcmv-ajax-search").filter(":not(.initialized)").each((function(){var e,t=jQuery(this),n=null!==(e=t.data("value"))&&void 0!==e?e:null;if(null!==n)for(var i in n)t.append(new Option(n[i],i,!0,!0));t.trigger("change"),t.selectWoo({allowClear:!0,placeholder:jQuery(this).data("placeholder"),minimumInputLength:"3",escapeMarkup:function(e){return e},ajax:{url:yith_wcmv_ajax.ajaxUrl,dataType:"json",delay:1e3,data:function(e){return{term:e.term,request:jQuery(this).data("action"),action:yith_wcmv_ajax.ajaxAction,security:yith_wcmv_ajax.ajaxNonce,context:"admin"}},processResults:function(e){var t=[];return e.success&&jQuery.each(e.data,(function(e,n){t.push({id:e,text:n})})),{results:t}},cache:!0}}).addClass("initialized").on("select2:select",(function(e){t.find("option.value-placeholder").remove()})).on("select2:unselect",(function(e){var n=e.params.data.id;t.find('option[value="'+n+'"]').remove(),t.find("option").length||t.append('<option value="" class="value-placeholder"></option>')}))})),this.container.find("select").filter(":not(.initialized)").each((function(){var e,t=jQuery(this),n=null!==(e=t.data("value"))&&void 0!==e?e:null,i=jQuery(this).find("option").filter('[value=""]'),a={minimumResultsForSearch:20};i.length&&(a.placeholder={id:"",text:i.text()},a.allowClear=!0),null!==n&&(n+="",t.val(n.split(",")).change()),t.selectWoo(a).addClass("initialized")}))}},{key:"isValidEmail",value:function(e){return e.toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}},{key:"validateEmail",value:function(e){var t,n=e.data.self,i=jQuery(this),a=i.val();a&&!n.isValidEmail(a)?n.addFieldError(null===(t=yith_vendors)||void 0===t?void 0:t.emailFieldError,i.attr("name")):n.resetFieldError(i.attr("name"))}},{key:"addFormError",value:function(e,t){t.prepend('<div id="error-message">'+e+"</div>")}},{key:"addFieldError",value:function(e,t,n){n&&n.length||(n=this.container);var i=n.find('[name="'+t+'"]');i.length||this.addFormError(e,n);var a=i.next(".error-msg");i.addClass("field-error"),a.length?a.html(e):i.after('<span class="error-msg">'+e+"</span>")}},{key:"resetFormError",value:function(e){var t=this;e&&e.length||(e=this.container),e.find("#error-message").remove(),e.find(".field-error").each((function(e,n){t.resetFieldError(jQuery(n).attr("name"))}))}},{key:"resetFieldError",value:function(e){if(e&&this.container.find('[name="'+e+'"]')){var t=this.container.find('[name="'+e+'"]');t.removeClass("field-error"),t.next(".error-msg").remove()}}},{key:"listenRequired",value:function(e){var t,n=e.data.self,i=jQuery(this),a=i.attr("name");i.val()?i.hasClass("ajax-check")||n.resetFieldError(a):n.addFieldError(null===(t=yith_vendors)||void 0===t?void 0:t.requiredFieldError,a)}},{key:"isFormWithErrors",value:function(){var e=this.container.closest("form");return e.find(":input").filter(".field-required").trigger("change"),!!e.find("#error-message, .field-error").length}},{key:"checkFormErrors",value:function(e){this.isFormWithErrors()&&(e.preventDefault(),jQuery("html").animate({scrollTop:this.container.find("#error-message, .field-error").first().offset().top-100},1e3))}}])}();if("undefined"!=typeof yith_wcmv_announcements)new(function(){return r((function e(){t(this,e),this.init()}),[{key:"init",value:function(){jQuery(document).on("click","a.page-title-action",{announcement:this},this.create),jQuery(document).on("click","button.save-announcement-modal",this.save),jQuery(document).on("click",".yith-plugin-fw__action-button--edit-action, a.row-title",{announcement:this},this.edit),jQuery(document).on("change",'input[name="_announcement_enabled"]',this.active)}},{key:"openModal",value:function(e){var t=wp.template("yith-wcmv-modal-announcement"),n=wp.template("yith-wcmv-modal-announcement-buttons");yith.ui.modal({width:700,closeSelector:".close-announcement-modal",classes:{wrap:"announcement-modal",content:"yith-plugin-ui"},title:yith_wcmv_announcements.modalTitle,content:t(e),footer:n({}),onCreate:function(){new l(jQuery("form.announcement-modal-form")).init()}})}},{key:"create",value:function(e){e.preventDefault(),e.data.announcement.openModal(yith_wcmv_announcements.defaultModalValues)}},{key:"edit",value:function(e){e.preventDefault();var t=e.data.announcement,n=jQuery(this).closest("tr"),i=n.find('[name="post[]"]').val();if(!i)return!1;o.abort(),n.data("announcement-data")?t.openModal(n.data("announcement-data")):o.call({request:"get_announcement_data",announcement_id:i},jQuery(this).closest("td")).done((function(e){e.success&&(n.data("announcement-data",e.data),t.openModal(e.data))}))}},{key:"active",value:function(e){e.preventDefault();var t=jQuery(this).is(":checked")?"yes":"no",n=jQuery(this).closest("tr").find('[name="post[]"]').val();o.call({request:"announcement_active_switch",announcement_id:n,active:t},jQuery(this).closest("td"),"POST")}},{key:"save",value:function(e){e.preventDefault(),jQuery(".announcement-modal-form").submit()}}])}());var c=window;for(var u in e)c[u]=e[u];e.__esModule&&Object.defineProperty(c,"__esModule",{value:!0})})();